var BoundObject=function(){function n(o){function t(n,e,r){for(var t=0;t<a.changeHandlers.length;t++)try{a.changeHandlers[t].call(o,{obj:o,key:n,newValue:e,oldValue:r})}catch(c){console.error(c.stack||c)}}if(this&&this instanceof n)throw new TypeError("BoundObject can not be used as class");if(!e(o))throw new TypeError("Input is not an bound object");r=!1;var a=o();r=!0;var c={};return c.assign=function(r,i){var s=o[r];if(e(s)&&(n(s).unlisten(a.childHandlers[r]),delete a.childHandlers[r]),o[r]=i,t(r,i,s),e(i)){var u=function(){t(r,i,i)};a.childHandlers[r]=u,n(i).listen(u)}return c},c.listen=function(n){if("function"!=typeof n)throw new TypeError("Handler must be a function");return-1==a.changeHandlers.indexOf(n)&&a.changeHandlers.push(n),c},c.unlisten=function(n){if("function"!=typeof n)throw new TypeError("Handler must be a function");var e=a.changeHandlers.indexOf(n);e>-1&&a.changeHandlers.splice(e,1)},c}function e(n){return"function"==typeof n&&n.prototype==o}function o(){}var r=!0;return n.create=function(n){var e={childHandlers:{},changeHandlers:[],refHandlers:[],unrefHandlers:[]},t=function(){if(r)throw new TypeError("A bound object can not be called as function");return e};if(t.prototype=o,n){for(var a in n){if("prototype"==a)throw new TypeError("A bound object can have prototype member");t[a]=n[a],console.log(">>",a,t[a],n[a])}console.log(Object.keys(t),Object.keys(n))}return t},n._assign=function(o,r,t){return e(o)?n(o).assign(r,t):o[r]=t,t},n}(),a=BoundObject.create({id:"a"});console.log(a.id),BoundObject(a).listen(function(n){console.log(n)}),BoundObject._assign(a,"b",1),BoundObject._assign(a,"b",BoundObject.create({id:"b"})),BoundObject._assign(a.b,"c",2),console.log(a.b);